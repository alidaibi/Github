<!doctype html>
<html lang="en">
 <head>
  <meta charset="UTF-8">
  <meta name="Generator" content="EditPlus®">
  <meta name="Author" content="">
  <meta name="Keywords" content="">
  <meta name="Description" content="">
  <title>Document</title>
  <style>
	#contrainer{
		width: 400px;
		height: 400px;
		border: 5px solid #ccc;
		margin: 0px auto;
		position: relative;
	}
  </style>
 </head>
 <script>
	window.onload = function(){
		var doc = window.document;
        var E = {
                on : function(el, type, fn){
                        el.addEventListener ?
                                el.addEventListener(type, fn, false) :
                        el.attachEvent ?
                                el.attachEvent("on" + type, fn) :
                        el['on'+type] = fn;
                },
                un : function(el,type,fn){
                        el.removeEventListener ?
                                el.removeEventListener(type, fn, false) :
                        el.detachEvent ?
                                el.detachEvent("on" + type, fn) :
                        el['on'+type] = null;
                },
                evt : function(e){
                        return e || window.event;
                }
        };
		var contrainer = document.getElementById("contrainer");
		var el = document.getElementById("d1");
		var maxX = contrainer.offsetWidth - 10 - el.offsetWidth;
		var maxY = contrainer.offsetHeight - 10 - el.offsetHeight;
		var minX = 0;
		var minY = 0;
		var diffX = 0;
		var diffY = 0;
		var moveX = 0;
		var moveY = 0;
		E.on(el,'mousedown',mousedown)
		function mousedown(e){
                        e = E.evt(e);
                        el.style.position = 'absolute';
                        el.style.cursor = 'move';
                        if(el.setCapture){ //IE
                                //E.on(el, "losecapture", mouseup);
                                el.setCapture();
                                e.cancelBubble = true;
                        }else if(window.captureEvents){ //标准DOM
                                e.stopPropagation();
                                //E.on(window, "blur", mouseup);
                                e.preventDefault();
                        }
                        diffX = e.clientX - el.offsetLeft;
                        diffY = e.clientY - el.offsetTop;
                        E.on(doc,'mousemove',mousemove);
                        E.on(doc,'mouseup',mouseup);
                }
                function mousemove(e){
                        e = E.evt(e), moveX = e.clientX - diffX, moveY = e.clientY - diffY;
                        
                                moveX < minX && (moveX = minX); // left 最小值
                                moveX > maxX && (moveX = maxX); // left 最大值
                                moveY < minY && (moveY = minY); // top 最小值
                                moveY > maxY && (moveY = maxY); // top 最大值
								el.style.left = moveX + 'px'
								el.style.top = moveY + 'px'
                      
                }
                function mouseup(e){
                        el.style.cursor = 'default';
                        E.un(doc,'mousemove',mousemove);
                        E.un(doc,'mouseup',mouseup);
                        
						console.log(1);
                }
	}
 </script>
 <body>
	<div id="contrainer">
		<img id ="d1" src="http://static.54seaman.com/images/face.jpg" style="width: 80px; height: 80px; position: absolute;top: 0px; left: 0px;">
	</div>
 </body>
</html>
